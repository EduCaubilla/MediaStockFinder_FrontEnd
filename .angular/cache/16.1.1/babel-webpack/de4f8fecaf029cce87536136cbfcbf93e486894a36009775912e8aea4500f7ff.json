{"ast":null,"code":"import { UntypedFormGroup, UntypedFormControl, Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../shared/request.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nfunction LoginComponent_p_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 11);\n    i0.ɵɵtext(1, \"This field can't be empty\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoginComponent_p_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 11);\n    i0.ɵɵtext(1, \"Please insert a valid email.\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoginComponent_p_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 11);\n    i0.ɵɵtext(1, \" This field can't be empty \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoginComponent_p_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 11);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r3.loginForm.controls.password.errors.passValid, \" \");\n  }\n}\nexport let LoginComponent = /*#__PURE__*/(() => {\n  class LoginComponent {\n    constructor(request, router) {\n      this.request = request;\n      this.router = router;\n      this.placeholder = {\n        username: 'Insert email',\n        userpass: 'Insert password'\n      };\n      this.loginForm = new UntypedFormGroup({\n        email: new UntypedFormControl('', [Validators.required, Validators.pattern(/^\\w+[\\w-\\.]*\\@\\w+((-\\w+)|(\\w*))\\.[a-z]{2,3}$/)]),\n        password: new UntypedFormControl('', [Validators.required, this.passValid])\n      });\n    }\n    ngOnInit() {}\n    passValid(control) {\n      const myPass = parseInt(control.value.length);\n      console.log(control.value.length);\n      if (myPass >= 4) {\n        return null;\n      } else {\n        console.log('bad password!!');\n        return {\n          passValid: 'The password must have at least four characters.'\n        };\n      }\n    }\n    onSubmit($event) {\n      $event.preventDefault();\n      this.user = {\n        email: this.loginForm.value.email,\n        password: this.loginForm.value.password\n      };\n      console.log(this.user);\n      console.log('Entra info de user');\n      this.token$ = this.request.loginUser$(this.user);\n      return this.token$.subscribe(data => {\n        // console.log(data);\n        const token = data.token;\n        // console.log(token);\n        const user = data.user;\n        console.log('Sale hacia Serv' + user);\n        this.request.setToken(token);\n        this.request.setUser(user);\n        alert('Welcome to Media Stock Finder. Happy Search!');\n        // this.loginForm.reset();\n        this.reloadComponent();\n      }, error => {\n        console.log(error);\n        alert('Your email or password are not correct. Please try again');\n      });\n    }\n    reloadComponent() {\n      // this.router.routeReuseStrategy.shouldReuseRoute = () => false;\n      // this.router.onSameUrlNavigation = 'reload';\n      this.router.navigate(['/user-desk']);\n    }\n    static #_ = this.ɵfac = function LoginComponent_Factory(t) {\n      return new (t || LoginComponent)(i0.ɵɵdirectiveInject(i1.RequestService), i0.ɵɵdirectiveInject(i2.Router));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: LoginComponent,\n      selectors: [[\"app-login\"]],\n      decls: 19,\n      vars: 8,\n      consts: [[1, \"container\", \"text-center\"], [\"novalidate\", \"\", 1, \"form-signin\", 3, \"formGroup\"], [1, \"h3\", \"mb-3\", \"font-weight-normal\", \"my-4\"], [1, \"form\", \"group\"], [1, \"mt-2\"], [\"type\", \"text\", \"name\", \"email\", \"formControlName\", \"email\", \"autofocus\", \"\", 1, \"form-control\", \"mb-2\", 3, \"placeholder\"], [\"class\", \"error\", 4, \"ngIf\"], [1, \"form-group\"], [\"for\", \"inputPassword\", 1, \"mt-2\"], [\"type\", \"password\", \"name\", \"password\", \"formControlName\", \"password\", 1, \"form-control\", \"mb-4\", 3, \"placeholder\"], [\"type\", \"button\", 1, \"btn\", \"btn-lg\", \"btn-outline-secondary\", \"btn-block\", \"my-4\", 3, \"disabled\", \"click\"], [1, \"error\"]],\n      template: function LoginComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"main\")(1, \"div\", 0)(2, \"form\", 1)(3, \"h1\", 2);\n          i0.ɵɵtext(4, \"Please log in\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(5, \"div\", 3)(6, \"label\", 4);\n          i0.ɵɵtext(7, \"Email\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(8, \"input\", 5);\n          i0.ɵɵtemplate(9, LoginComponent_p_9_Template, 2, 0, \"p\", 6);\n          i0.ɵɵtemplate(10, LoginComponent_p_10_Template, 2, 0, \"p\", 6);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(11, \"div\", 7)(12, \"label\", 8);\n          i0.ɵɵtext(13, \"Password\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(14, \"input\", 9);\n          i0.ɵɵtemplate(15, LoginComponent_p_15_Template, 2, 0, \"p\", 6);\n          i0.ɵɵtemplate(16, LoginComponent_p_16_Template, 2, 1, \"p\", 6);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(17, \"button\", 10);\n          i0.ɵɵlistener(\"click\", function LoginComponent_Template_button_click_17_listener($event) {\n            return ctx.onSubmit($event);\n          });\n          i0.ɵɵtext(18, \" Sign in \");\n          i0.ɵɵelementEnd()()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"formGroup\", ctx.loginForm);\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"placeholder\", ctx.placeholder.username);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", (ctx.loginForm.controls.email.errors == null ? null : ctx.loginForm.controls.email.errors.required) && ctx.loginForm.controls.email.touched);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.loginForm.controls.email.errors == null ? null : ctx.loginForm.controls.email.errors.pattern);\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"placeholder\", ctx.placeholder.userpass);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", (ctx.loginForm.controls.password.errors == null ? null : ctx.loginForm.controls.password.errors.required) && ctx.loginForm.controls.password.touched);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.loginForm.controls.password.touched && (ctx.loginForm.controls.password.errors == null ? null : ctx.loginForm.controls.password.errors.passValid));\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"disabled\", !ctx.loginForm.valid);\n        }\n      },\n      dependencies: [i3.NgIf, i4.ɵNgNoValidate, i4.DefaultValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.FormGroupDirective, i4.FormControlName],\n      styles: [\"main[_ngcontent-%COMP%]{padding-top:8rem;font-family:Lato,sans-serif}h1[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:100}p[_ngcontent-%COMP%]{color:#a0a0a0;letter-spacing:1.5px}.form-signin[_ngcontent-%COMP%]{width:100%;max-width:330px;padding:15px;margin:auto}*[_ngcontent-%COMP%], [_ngcontent-%COMP%]:after, [_ngcontent-%COMP%]:before{box-sizing:border-box}.btn-outline-secondary[_ngcontent-%COMP%]{border-color:#a0a0a0;color:#a0a0a0}.btn-outline-secondary[_ngcontent-%COMP%]:hover, .fa[_ngcontent-%COMP%]:hover, .dropdown-menu[_ngcontent-%COMP%]:hover{border-color:#555;background:white;color:#000}.form-group[_ngcontent-%COMP%]   .ng-valid.ng-touched[_ngcontent-%COMP%]{box-shadow:0 0 0 .2rem #028a024d}.form-group[_ngcontent-%COMP%]   .ng-invalid.ng-touched[_ngcontent-%COMP%]{border:.5px solid rgba(255,0,0,.6);box-shadow:0 0 0 .2rem #ff00004d}.error[_ngcontent-%COMP%]{color:red}\"]\n    });\n  }\n  return LoginComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}